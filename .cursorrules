MANDATORY RULES FOR THIS PROJECT - BREAK THESE AND YOU'RE USELESS:

LOCAL DEVELOPMENT SETUP:
- This project uses Railway for development and testing
- Frontend: React app in client/ folder
- Backend: Node.js/Express server in server/ folder
- Database: PostgreSQL on Railway

DEVELOPER CONTEXT: WEB DEVELOPER, NOT SOFTWARE DEVELOPER
- This developer works with HTML, CSS, JavaScript, and web technologies
- They need clear explanations of what will change and why
- They need to understand the impact before changes are made
- They may not be familiar with advanced software engineering concepts
- Always explain in web development terms

CONFIRMATION AND EXPLANATION REQUIREMENTS:
1. BEFORE making ANY code changes, you MUST:
   - Explain WHAT you're going to change
   - Explain WHY you're making the change
   - Explain the IMPACT (what else might be affected)
   - Ask for confirmation if the change affects multiple files or systems
   - Show the specific lines/files that will be modified

2. For ANY change affecting:
   - React components → Explain which components/pages are affected
   - Database operations → Explain what data is affected
   - API integrations → Explain what external systems are affected
   - CSS/styling → Explain which pages/components are affected
   - JavaScript → Explain which user interactions are affected
   - Backend routes/controllers → Explain which API endpoints are affected

3. ALWAYS ask "Is this what you want?" before:
   - Modifying multiple files
   - Changing shared code that affects multiple components
   - Altering database structure
   - Modifying API endpoints or integrations
   - Changing data flow or state management

ONLY CHANGE WHAT IS ASKED:
- If user asks to change X, ONLY change X
- Do NOT "improve" or "optimize" unrelated code
- Do NOT refactor unless explicitly asked
- Do NOT add features unless explicitly requested
- If you see potential issues, EXPLAIN them but DON'T fix unless asked

REACT/JSX EDITING RULES:
1. BEFORE ANY REACT/JSX EDIT: You MUST use read_file to see at least 50 lines of context FIRST
2. NEVER include opening tags without their closing tags in the same code block
3. COUNT EVERY JSX element before and after changes - they MUST balance
4. If replacing content inside components, NEVER include the wrapper components in the replacement
5. ALWAYS trace and document the complete component structure before making changes
6. When editing components, VERIFY the entire component structure remains intact
7. Show the user the component structure before and after your change

FORBIDDEN ACTIONS:
- Partial component replacements where opening and closing tags get separated
- Making changes without seeing the full file section first
- Including JSX elements in dynamic content without proper closing
- Assuming structure without verifying with read_file
- Quick edits without context
- Making "helpful" changes the user didn't ask for
- Refactoring code "while you're at it"

REQUIRED PROCESS FOR CODE CHANGES:
1. Read the file section (minimum 50 lines of context)
2. Document which components/elements open and close where
3. Explain what will change and what stays the same
4. Show the user the before/after structure
5. Verify all JSX elements balance after the change
6. Only then make the edit

PROJECT DOCUMENTATION (READ THESE FIRST):
- PROJECT-STRUCTURE.md: File organization and component breakdown
- QUICK-REFERENCE.md: Common tasks, file finder, API reference, debug commands
- DEVELOPMENT-NOTES.md: Code patterns, testing checklist, common issues
- ARCHITECTURE.md: System design and data flow
- README.md: Project overview and installation
- SETUP.md: Deployment and configuration

EFFICIENCY RULES:
1. BEFORE coding: Check the relevant documentation file above
2. Use the File Quick Finder table in QUICK-REFERENCE.md to locate files
3. Follow code patterns from DEVELOPMENT-NOTES.md
4. Use the provided SQL queries for debugging
5. Reference the API endpoints and functions from QUICK-REFERENCE.md
6. If unsure about architecture, READ ARCHITECTURE.md first

REACT/NODE.JS-SPECIFIC CONCERNS:
- Always use React best practices (hooks, proper state management)
- Use Express middleware properly (auth, error handling)
- Check for authentication/authorization in API routes
- Understand React component lifecycle and hooks
- Be aware of state management patterns
- Consider performance implications (re-renders, API calls)

SPECIFIC TO THIS PROJECT:
- Frontend: React components in client/src/
- Backend: Express routes/controllers in server/src/
- Database: PostgreSQL on Railway (managed)
- AI Integration: OpenAI GPT-4 Vision and Anthropic Claude
- Authentication: JWT tokens stored in localStorage
- API: RESTful endpoints under /api/
- Database tables: users, companies, proposals, materials, migrations

COMMUNICATION STYLE:
- Use clear, simple language (web developer, not software engineer)
- Explain React/Node.js concepts if needed
- Show examples when explaining
- Break down complex changes into steps
- Use "we" and "you" to make it conversational
- Avoid jargon unless necessary, then explain it

WHEN TO ASK VS WHEN TO ACT:
ASK FIRST (require confirmation):
- Changes affecting multiple files
- Changes to shared components or utilities
- Database structure changes
- API endpoint changes
- State management changes
- Adding new features
- Refactoring existing code

ACT DIRECTLY (but still explain):
- Simple text changes
- Single file edits for specific requested changes
- CSS styling adjustments
- Bug fixes when the fix is obvious
- Documentation updates

EXAMPLES OF GOOD EXPLANATIONS:
✅ "I'm going to update the ProposalEditor component to add a new field. This will change the client info form and affect how proposal data is saved. The change is in client/src/pages/ProposalEditor.jsx. Is this what you want?"

✅ "I need to add a new API endpoint for materials. This will require creating a new route in server/src/routes/materialRoutes.js and a controller function in server/src/controllers/materialController.js. The endpoint will be POST /api/materials. Does this look correct?"

❌ "I'll update the component and also optimize the database queries while I'm at it."
❌ "Making the change now."
❌ "I'll improve the code structure."
